# Malware-Detection

•This project aims to detect malware based on dynamic API call sequences. It utilizes a combination of Convolutional Neural Networks (CNN) and Long Short-Term Memory (LSTM) layers to analyze the API call patterns and make predictions. 

•The dataset is preprocessed, including scaling and addressing class imbalance using SMOTE. Grid search is applied to find the best hyperparameters for the model. The performance is evaluated using accuracy, classification report, confusion matrix, ROC curve, and precision-recall curve. The trained model can be saved and used for future malware detection tasks.

**<h2>Usage</h2>**

To use the code, follow these steps:

1. Preprocess the dataset by scaling and addressing class imbalance using SMOTE.
2. Perform grid search to find the best hyperparameters for the CNN and LSTM model.
3. Train the model using the optimized hyperparameters and the preprocessed dataset.
4. Evaluate the model's performance using accuracy, precision, recall, F1-score, ROC curve, and precision-recall curve.

**<h3>Here is a description of each file used in implementing the CNN model:</h3>**

•**vgg16.ipynb** - This notebook implements a malware detection model using a pre-trained VGG16 convolutional neural network. The model is trained and evaluated using a dataset split into training, validation, and test sets. The VGG16 model is used as a feature extractor, and additional layers are added for classification. The model is trained on the training set and evaluated on the validation and test sets, with the test accuracy and confusion matrix computed.

•**resnet18.ipynb** - This code implements a malware detection model using the ResNet50 convolutional neural network. The model is trained and evaluated using a dataset of malware images, and achieves a test accuracy of 90.91%. The confusion matrix is also generated to assess the model's performance across different malware classes.

•**ourCNN.ipynb** - This code is training a convolutional neural network (CNN) model to classify malware images using the Keras library. The model is trained on a dataset of malware images with data augmentation techniques applied. After training, the model is evaluated using a separate test dataset, and the accuracy and confusion matrix are calculated.

•**InceptionV3.ipynb** - This code demonstrates the process of training and evaluating a deep learning model for image classification using the InceptionV3 architecture. It uses the ImageDataGenerator class from Keras to perform data augmentation and generate batches of training, validation, and test data. The top layers of the InceptionV3 model are removed and replaced with new layers for the specific classification task. The model is then compiled, trained using the training data, and evaluated using the validation and test data. Finally, the code generates a confusion matrix to visualize the performance of the model in predicting different classes.

![cnn](https://github.com/yaaaash/Malware-Detection/assets/87315730/4140c730-1550-4eca-a0ff-8569218f474f)

**<h3>Here is a description of each file used in implementing the combination of CNN and LSTM model:</h3>**

•**CNN-LSTM_BalancedData.ipynb** - This code demonstrates the process of training and evaluating a machine learning model for malware detection based on dynamic API call sequences. It uses a combination of Convolutional Neural Networks (CNN) and Long Short-Term Memory (LSTM) layers to analyze the API call sequences and make predictions. The data is preprocessed by scaling and applying SMOTE to address class imbalance. Grid search is performed to find the best hyperparameters for the model. The model is trained and evaluated using accuracy, classification report, confusion matrix, ROC curve, and precision-recall curve. Finally, the trained model is saved for future use.

**<h2>Results</h2>**

The accuracy results showcase the impact of these techniques in addressing class imbalance and improving the model's performance for accurate malware detection:

![results](https://github.com/yaaaash/Malware-Detection/assets/87315730/1261b2ba-e1ea-48d9-a319-1033422a9e1b)

Additionally, the ROC curve and precision-recall curve are used to evaluate the model's performance in terms of the true positive rate, false positive rate, precision, and recall.

**<h2>Conclusion</h2>**

In conclusion, this project demonstrates the effectiveness of using a combination of CNN and LSTM for malware detection. By leveraging CNN's feature extraction capabilities and LSTM's ability to capture sequential patterns, the model achieves accurate predictions. Further improvements can be explored by considering additional features or exploring alternative deep learning architectures. The trained model can be utilized for real-world malware detection tasks, enhancing cybersecurity measures.
