# Malware-Detection

•This project aims to detect malware based on dynamic API call sequences. It utilizes a combination of Convolutional Neural Networks (CNN) and Long Short-Term Memory (LSTM) layers to analyze the API call patterns and make predictions. 

•The dataset is preprocessed, including scaling and addressing class imbalance using SMOTE. Grid search is applied to find the best hyperparameters for the model. The performance is evaluated using accuracy, classification report, confusion matrix, ROC curve, and precision-recall curve. The trained model can be saved and used for future malware detection tasks.

**Here is a description of each file used in implementing the CNN model:**

•**vgg16.ipynb** - This notebook implements a malware detection model using a pre-trained VGG16 convolutional neural network. The model is trained and evaluated using a dataset split into training, validation, and test sets. The VGG16 model is used as a feature extractor, and additional layers are added for classification. The model is trained on the training set and evaluated on the validation and test sets, with the test accuracy and confusion matrix computed.

•**resnet18.ipynb** - This code implements a malware detection model using the ResNet50 convolutional neural network. The model is trained and evaluated using a dataset of malware images, and achieves a test accuracy of 90.91%. The confusion matrix is also generated to assess the model's performance across different malware classes.

•**ourCNN.ipynb** - This code is training a convolutional neural network (CNN) model to classify malware images using the Keras library. The model is trained on a dataset of malware images with data augmentation techniques applied. After training, the model is evaluated using a separate test dataset, and the accuracy and confusion matrix are calculated.

•**InceptionV3.ipynb** - This code demonstrates the process of training and evaluating a deep learning model for image classification using the InceptionV3 architecture. It uses the ImageDataGenerator class from Keras to perform data augmentation and generate batches of training, validation, and test data. The top layers of the InceptionV3 model are removed and replaced with new layers for the specific classification task. The model is then compiled, trained using the training data, and evaluated using the validation and test data. Finally, the code generates a confusion matrix to visualize the performance of the model in predicting different classes.

![cnn](https://github.com/yaaaash/Malware-Detection/assets/87315730/4140c730-1550-4eca-a0ff-8569218f474f)

**Here is a description of each file used in implementing the combination of CNN and LSTM model:**

•**CNN-LSTM_BalancedData.ipynb** - This code demonstrates the process of training and evaluating a machine learning model for malware detection based on dynamic API call sequences. It uses a combination of Convolutional Neural Networks (CNN) and Long Short-Term Memory (LSTM) layers to analyze the API call sequences and make predictions. The data is preprocessed by scaling and applying SMOTE to address class imbalance. Grid search is performed to find the best hyperparameters for the model. The model is trained and evaluated using accuracy, classification report, confusion matrix, ROC curve, and precision-recall curve. Finally, the trained model is saved for future use.

**Results**

Here is the final Accuracy result of the imbalanced data and balanced data using various balancing techniques:

![results](https://github.com/yaaaash/Malware-Detection/assets/87315730/1261b2ba-e1ea-48d9-a319-1033422a9e1b)
